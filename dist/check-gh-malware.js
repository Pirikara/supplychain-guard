"use strict";var ot=Object.create;var pe=Object.defineProperty;var ct=Object.getOwnPropertyDescriptor;var at=Object.getOwnPropertyNames;var lt=Object.getPrototypeOf,ut=Object.prototype.hasOwnProperty;var p=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ft=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of at(e))!ut.call(t,n)&&n!==r&&pe(t,n,{get:()=>e[n],enumerable:!(s=ct(e,n))||s.enumerable});return t};var Et=(t,e,r)=>(r=t!=null?ot(lt(t)):{},ft(e||!t||!t.__esModule?pe(r,"default",{value:t,enumerable:!0}):r,t));var v=p((Ei,me)=>{"use strict";var ht="2.0.0",pt=Number.MAX_SAFE_INTEGER||9007199254740991,mt=16,$t=250,Rt=["major","premajor","minor","preminor","patch","prepatch","prerelease"];me.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:mt,MAX_SAFE_BUILD_LENGTH:$t,MAX_SAFE_INTEGER:pt,RELEASE_TYPES:Rt,SEMVER_SPEC_VERSION:ht,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var P=p((hi,$e)=>{"use strict";var It=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};$e.exports=It});var q=p((T,Re)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:K,MAX_SAFE_BUILD_LENGTH:Lt,MAX_LENGTH:Nt}=v(),dt=P();T=Re.exports={};var Ot=T.re=[],St=T.safeRe=[],c=T.src=[],At=T.safeSrc=[],a=T.t={},Tt=0,J="[a-zA-Z0-9-]",gt=[["\\s",1],["\\d",Nt],[J,Lt]],qt=t=>{for(let[e,r]of gt)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},m=(t,e,r)=>{let s=qt(e),n=Tt++;dt(t,n,e),a[t]=n,c[n]=e,At[n]=s,Ot[n]=new RegExp(e,r?"g":void 0),St[n]=new RegExp(s,r?"g":void 0)};m("NUMERICIDENTIFIER","0|[1-9]\\d*");m("NUMERICIDENTIFIERLOOSE","\\d+");m("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${J}*`);m("MAINVERSION",`(${c[a.NUMERICIDENTIFIER]})\\.(${c[a.NUMERICIDENTIFIER]})\\.(${c[a.NUMERICIDENTIFIER]})`);m("MAINVERSIONLOOSE",`(${c[a.NUMERICIDENTIFIERLOOSE]})\\.(${c[a.NUMERICIDENTIFIERLOOSE]})\\.(${c[a.NUMERICIDENTIFIERLOOSE]})`);m("PRERELEASEIDENTIFIER",`(?:${c[a.NONNUMERICIDENTIFIER]}|${c[a.NUMERICIDENTIFIER]})`);m("PRERELEASEIDENTIFIERLOOSE",`(?:${c[a.NONNUMERICIDENTIFIER]}|${c[a.NUMERICIDENTIFIERLOOSE]})`);m("PRERELEASE",`(?:-(${c[a.PRERELEASEIDENTIFIER]}(?:\\.${c[a.PRERELEASEIDENTIFIER]})*))`);m("PRERELEASELOOSE",`(?:-?(${c[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[a.PRERELEASEIDENTIFIERLOOSE]})*))`);m("BUILDIDENTIFIER",`${J}+`);m("BUILD",`(?:\\+(${c[a.BUILDIDENTIFIER]}(?:\\.${c[a.BUILDIDENTIFIER]})*))`);m("FULLPLAIN",`v?${c[a.MAINVERSION]}${c[a.PRERELEASE]}?${c[a.BUILD]}?`);m("FULL",`^${c[a.FULLPLAIN]}$`);m("LOOSEPLAIN",`[v=\\s]*${c[a.MAINVERSIONLOOSE]}${c[a.PRERELEASELOOSE]}?${c[a.BUILD]}?`);m("LOOSE",`^${c[a.LOOSEPLAIN]}$`);m("GTLT","((?:<|>)?=?)");m("XRANGEIDENTIFIERLOOSE",`${c[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);m("XRANGEIDENTIFIER",`${c[a.NUMERICIDENTIFIER]}|x|X|\\*`);m("XRANGEPLAIN",`[v=\\s]*(${c[a.XRANGEIDENTIFIER]})(?:\\.(${c[a.XRANGEIDENTIFIER]})(?:\\.(${c[a.XRANGEIDENTIFIER]})(?:${c[a.PRERELEASE]})?${c[a.BUILD]}?)?)?`);m("XRANGEPLAINLOOSE",`[v=\\s]*(${c[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[a.XRANGEIDENTIFIERLOOSE]})(?:${c[a.PRERELEASELOOSE]})?${c[a.BUILD]}?)?)?`);m("XRANGE",`^${c[a.GTLT]}\\s*${c[a.XRANGEPLAIN]}$`);m("XRANGELOOSE",`^${c[a.GTLT]}\\s*${c[a.XRANGEPLAINLOOSE]}$`);m("COERCEPLAIN",`(^|[^\\d])(\\d{1,${K}})(?:\\.(\\d{1,${K}}))?(?:\\.(\\d{1,${K}}))?`);m("COERCE",`${c[a.COERCEPLAIN]}(?:$|[^\\d])`);m("COERCEFULL",c[a.COERCEPLAIN]+`(?:${c[a.PRERELEASE]})?(?:${c[a.BUILD]})?(?:$|[^\\d])`);m("COERCERTL",c[a.COERCE],!0);m("COERCERTLFULL",c[a.COERCEFULL],!0);m("LONETILDE","(?:~>?)");m("TILDETRIM",`(\\s*)${c[a.LONETILDE]}\\s+`,!0);T.tildeTrimReplace="$1~";m("TILDE",`^${c[a.LONETILDE]}${c[a.XRANGEPLAIN]}$`);m("TILDELOOSE",`^${c[a.LONETILDE]}${c[a.XRANGEPLAINLOOSE]}$`);m("LONECARET","(?:\\^)");m("CARETTRIM",`(\\s*)${c[a.LONECARET]}\\s+`,!0);T.caretTrimReplace="$1^";m("CARET",`^${c[a.LONECARET]}${c[a.XRANGEPLAIN]}$`);m("CARETLOOSE",`^${c[a.LONECARET]}${c[a.XRANGEPLAINLOOSE]}$`);m("COMPARATORLOOSE",`^${c[a.GTLT]}\\s*(${c[a.LOOSEPLAIN]})$|^$`);m("COMPARATOR",`^${c[a.GTLT]}\\s*(${c[a.FULLPLAIN]})$|^$`);m("COMPARATORTRIM",`(\\s*)${c[a.GTLT]}\\s*(${c[a.LOOSEPLAIN]}|${c[a.XRANGEPLAIN]})`,!0);T.comparatorTrimReplace="$1$2$3";m("HYPHENRANGE",`^\\s*(${c[a.XRANGEPLAIN]})\\s+-\\s+(${c[a.XRANGEPLAIN]})\\s*$`);m("HYPHENRANGELOOSE",`^\\s*(${c[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[a.XRANGEPLAINLOOSE]})\\s*$`);m("STAR","(<|>)?=?\\s*\\*");m("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");m("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var F=p((pi,Ie)=>{"use strict";var wt=Object.freeze({loose:!0}),vt=Object.freeze({}),Pt=t=>t?typeof t!="object"?wt:t:vt;Ie.exports=Pt});var Z=p((mi,de)=>{"use strict";var Le=/^[0-9]+$/,Ne=(t,e)=>{let r=Le.test(t),s=Le.test(e);return r&&s&&(t=+t,e=+e),t===e?0:r&&!s?-1:s&&!r?1:t<e?-1:1},xt=(t,e)=>Ne(e,t);de.exports={compareIdentifiers:Ne,rcompareIdentifiers:xt}});var L=p(($i,Se)=>{"use strict";var j=P(),{MAX_LENGTH:Oe,MAX_SAFE_INTEGER:U}=v(),{safeRe:X,t:V}=q(),Ct=F(),{compareIdentifiers:w}=Z(),Q=class t{constructor(e,r){if(r=Ct(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Oe)throw new TypeError(`version is longer than ${Oe} characters`);j("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let s=e.trim().match(r.loose?X[V.LOOSE]:X[V.FULL]);if(!s)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>U||this.major<0)throw new TypeError("Invalid major version");if(this.minor>U||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>U||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){let i=+n;if(i>=0&&i<U)return i}return n}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(j("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),w(this.major,e.major)||w(this.minor,e.minor)||w(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let s=this.prerelease[r],n=e.prerelease[r];if(j("prerelease compare",r,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return w(s,n)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let s=this.build[r],n=e.build[r];if(j("build compare",r,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return w(s,n)}while(++r)}inc(e,r,s){if(e.startsWith("pre")){if(!r&&s===!1)throw new Error("invalid increment argument: identifier is empty");if(r){let n=`-${r}`.match(this.options.loose?X[V.PRERELEASELOOSE]:X[V.PRERELEASE]);if(!n||n[1]!==r)throw new Error(`invalid identifier: ${r}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,s);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,s);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,s),this.inc("pre",r,s);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,s),this.inc("pre",r,s);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let n=Number(s)?1:0;if(this.prerelease.length===0)this.prerelease=[n];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(r===this.prerelease.join(".")&&s===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(r){let i=[r,n];s===!1&&(i=[r]),w(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Se.exports=Q});var g=p((Ri,Te)=>{"use strict";var Ae=L(),yt=(t,e,r=!1)=>{if(t instanceof Ae)return t;try{return new Ae(t,e)}catch(s){if(!r)return null;throw s}};Te.exports=yt});var qe=p((Ii,ge)=>{"use strict";var Dt=g(),Gt=(t,e)=>{let r=Dt(t,e);return r?r.version:null};ge.exports=Gt});var ve=p((Li,we)=>{"use strict";var Ft=g(),jt=(t,e)=>{let r=Ft(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};we.exports=jt});var Ce=p((Ni,xe)=>{"use strict";var Pe=L(),Ut=(t,e,r,s,n)=>{typeof r=="string"&&(n=s,s=r,r=void 0);try{return new Pe(t instanceof Pe?t.version:t,r).inc(e,s,n).version}catch{return null}};xe.exports=Ut});var Ge=p((di,De)=>{"use strict";var ye=g(),Xt=(t,e)=>{let r=ye(t,null,!0),s=ye(e,null,!0),n=r.compare(s);if(n===0)return null;let i=n>0,o=i?r:s,l=i?s:r,u=!!o.prerelease.length;if(!!l.prerelease.length&&!u){if(!l.patch&&!l.minor)return"major";if(l.compareMain(o)===0)return l.minor&&!l.patch?"minor":"patch"}let $=u?"pre":"";return r.major!==s.major?$+"major":r.minor!==s.minor?$+"minor":r.patch!==s.patch?$+"patch":"prerelease"};De.exports=Xt});var je=p((Oi,Fe)=>{"use strict";var Vt=L(),_t=(t,e)=>new Vt(t,e).major;Fe.exports=_t});var Xe=p((Si,Ue)=>{"use strict";var bt=L(),Ht=(t,e)=>new bt(t,e).minor;Ue.exports=Ht});var _e=p((Ai,Ve)=>{"use strict";var kt=L(),Mt=(t,e)=>new kt(t,e).patch;Ve.exports=Mt});var He=p((Ti,be)=>{"use strict";var Bt=g(),Yt=(t,e)=>{let r=Bt(t,e);return r&&r.prerelease.length?r.prerelease:null};be.exports=Yt});var S=p((gi,Me)=>{"use strict";var ke=L(),Wt=(t,e,r)=>new ke(t,r).compare(new ke(e,r));Me.exports=Wt});var Ye=p((qi,Be)=>{"use strict";var zt=S(),Kt=(t,e,r)=>zt(e,t,r);Be.exports=Kt});var ze=p((wi,We)=>{"use strict";var Jt=S(),Zt=(t,e)=>Jt(t,e,!0);We.exports=Zt});var _=p((vi,Je)=>{"use strict";var Ke=L(),Qt=(t,e,r)=>{let s=new Ke(t,r),n=new Ke(e,r);return s.compare(n)||s.compareBuild(n)};Je.exports=Qt});var Qe=p((Pi,Ze)=>{"use strict";var es=_(),rs=(t,e)=>t.sort((r,s)=>es(r,s,e));Ze.exports=rs});var rr=p((xi,er)=>{"use strict";var ts=_(),ss=(t,e)=>t.sort((r,s)=>ts(s,r,e));er.exports=ss});var x=p((Ci,tr)=>{"use strict";var ns=S(),is=(t,e,r)=>ns(t,e,r)>0;tr.exports=is});var b=p((yi,sr)=>{"use strict";var os=S(),cs=(t,e,r)=>os(t,e,r)<0;sr.exports=cs});var ee=p((Di,nr)=>{"use strict";var as=S(),ls=(t,e,r)=>as(t,e,r)===0;nr.exports=ls});var re=p((Gi,ir)=>{"use strict";var us=S(),fs=(t,e,r)=>us(t,e,r)!==0;ir.exports=fs});var H=p((Fi,or)=>{"use strict";var Es=S(),hs=(t,e,r)=>Es(t,e,r)>=0;or.exports=hs});var k=p((ji,cr)=>{"use strict";var ps=S(),ms=(t,e,r)=>ps(t,e,r)<=0;cr.exports=ms});var te=p((Ui,ar)=>{"use strict";var $s=ee(),Rs=re(),Is=x(),Ls=H(),Ns=b(),ds=k(),Os=(t,e,r,s)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return $s(t,r,s);case"!=":return Rs(t,r,s);case">":return Is(t,r,s);case">=":return Ls(t,r,s);case"<":return Ns(t,r,s);case"<=":return ds(t,r,s);default:throw new TypeError(`Invalid operator: ${e}`)}};ar.exports=Os});var ur=p((Xi,lr)=>{"use strict";var Ss=L(),As=g(),{safeRe:M,t:B}=q(),Ts=(t,e)=>{if(t instanceof Ss)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?M[B.COERCEFULL]:M[B.COERCE]);else{let u=e.includePrerelease?M[B.COERCERTLFULL]:M[B.COERCERTL],h;for(;(h=u.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||h.index+h[0].length!==r.index+r[0].length)&&(r=h),u.lastIndex=h.index+h[1].length+h[2].length;u.lastIndex=-1}if(r===null)return null;let s=r[2],n=r[3]||"0",i=r[4]||"0",o=e.includePrerelease&&r[5]?`-${r[5]}`:"",l=e.includePrerelease&&r[6]?`+${r[6]}`:"";return As(`${s}.${n}.${i}${o}${l}`,e)};lr.exports=Ts});var Er=p((Vi,fr)=>{"use strict";var se=class{constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let n=this.map.keys().next().value;this.delete(n)}this.map.set(e,r)}return this}};fr.exports=se});var A=p((_i,$r)=>{"use strict";var gs=/\s+/g,ne=class t{constructor(e,r){if(r=ws(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof ie)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().replace(gs," "),this.set=this.raw.split("||").map(s=>this.parseRange(s.trim())).filter(s=>s.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let s=this.set[0];if(this.set=this.set.filter(n=>!pr(n[0])),this.set.length===0)this.set=[s];else if(this.set.length>1){for(let n of this.set)if(n.length===1&&Gs(n[0])){this.set=[n];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let r=this.set[e];for(let s=0;s<r.length;s++)s>0&&(this.formatted+=" "),this.formatted+=r[s].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let s=((this.options.includePrerelease&&ys)|(this.options.loose&&Ds))+":"+e,n=hr.get(s);if(n)return n;let i=this.options.loose,o=i?O[N.HYPHENRANGELOOSE]:O[N.HYPHENRANGE];e=e.replace(o,Ms(this.options.includePrerelease)),R("hyphen replace",e),e=e.replace(O[N.COMPARATORTRIM],Ps),R("comparator trim",e),e=e.replace(O[N.TILDETRIM],xs),R("tilde trim",e),e=e.replace(O[N.CARETTRIM],Cs),R("caret trim",e);let l=e.split(" ").map(f=>Fs(f,this.options)).join(" ").split(/\s+/).map(f=>ks(f,this.options));i&&(l=l.filter(f=>(R("loose invalid filter",f,this.options),!!f.match(O[N.COMPARATORLOOSE])))),R("range list",l);let u=new Map,h=l.map(f=>new ie(f,this.options));for(let f of h){if(pr(f))return[f];u.set(f.value,f)}u.size>1&&u.has("")&&u.delete("");let $=[...u.values()];return hr.set(s,$),$}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(s=>mr(s,r)&&e.set.some(n=>mr(n,r)&&s.every(i=>n.every(o=>i.intersects(o,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new vs(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(Bs(this.set[r],e,this.options))return!0;return!1}};$r.exports=ne;var qs=Er(),hr=new qs,ws=F(),ie=C(),R=P(),vs=L(),{safeRe:O,t:N,comparatorTrimReplace:Ps,tildeTrimReplace:xs,caretTrimReplace:Cs}=q(),{FLAG_INCLUDE_PRERELEASE:ys,FLAG_LOOSE:Ds}=v(),pr=t=>t.value==="<0.0.0-0",Gs=t=>t.value==="",mr=(t,e)=>{let r=!0,s=t.slice(),n=s.pop();for(;r&&s.length;)r=s.every(i=>n.intersects(i,e)),n=s.pop();return r},Fs=(t,e)=>(R("comp",t,e),t=Xs(t,e),R("caret",t),t=js(t,e),R("tildes",t),t=_s(t,e),R("xrange",t),t=Hs(t,e),R("stars",t),t),d=t=>!t||t.toLowerCase()==="x"||t==="*",js=(t,e)=>t.trim().split(/\s+/).map(r=>Us(r,e)).join(" "),Us=(t,e)=>{let r=e.loose?O[N.TILDELOOSE]:O[N.TILDE];return t.replace(r,(s,n,i,o,l)=>{R("tilde",t,s,n,i,o,l);let u;return d(n)?u="":d(i)?u=`>=${n}.0.0 <${+n+1}.0.0-0`:d(o)?u=`>=${n}.${i}.0 <${n}.${+i+1}.0-0`:l?(R("replaceTilde pr",l),u=`>=${n}.${i}.${o}-${l} <${n}.${+i+1}.0-0`):u=`>=${n}.${i}.${o} <${n}.${+i+1}.0-0`,R("tilde return",u),u})},Xs=(t,e)=>t.trim().split(/\s+/).map(r=>Vs(r,e)).join(" "),Vs=(t,e)=>{R("caret",t,e);let r=e.loose?O[N.CARETLOOSE]:O[N.CARET],s=e.includePrerelease?"-0":"";return t.replace(r,(n,i,o,l,u)=>{R("caret",t,n,i,o,l,u);let h;return d(i)?h="":d(o)?h=`>=${i}.0.0${s} <${+i+1}.0.0-0`:d(l)?i==="0"?h=`>=${i}.${o}.0${s} <${i}.${+o+1}.0-0`:h=`>=${i}.${o}.0${s} <${+i+1}.0.0-0`:u?(R("replaceCaret pr",u),i==="0"?o==="0"?h=`>=${i}.${o}.${l}-${u} <${i}.${o}.${+l+1}-0`:h=`>=${i}.${o}.${l}-${u} <${i}.${+o+1}.0-0`:h=`>=${i}.${o}.${l}-${u} <${+i+1}.0.0-0`):(R("no pr"),i==="0"?o==="0"?h=`>=${i}.${o}.${l}${s} <${i}.${o}.${+l+1}-0`:h=`>=${i}.${o}.${l}${s} <${i}.${+o+1}.0-0`:h=`>=${i}.${o}.${l} <${+i+1}.0.0-0`),R("caret return",h),h})},_s=(t,e)=>(R("replaceXRanges",t,e),t.split(/\s+/).map(r=>bs(r,e)).join(" ")),bs=(t,e)=>{t=t.trim();let r=e.loose?O[N.XRANGELOOSE]:O[N.XRANGE];return t.replace(r,(s,n,i,o,l,u)=>{R("xRange",t,s,n,i,o,l,u);let h=d(i),$=h||d(o),f=$||d(l),I=f;return n==="="&&I&&(n=""),u=e.includePrerelease?"-0":"",h?n===">"||n==="<"?s="<0.0.0-0":s="*":n&&I?($&&(o=0),l=0,n===">"?(n=">=",$?(i=+i+1,o=0,l=0):(o=+o+1,l=0)):n==="<="&&(n="<",$?i=+i+1:o=+o+1),n==="<"&&(u="-0"),s=`${n+i}.${o}.${l}${u}`):$?s=`>=${i}.0.0${u} <${+i+1}.0.0-0`:f&&(s=`>=${i}.${o}.0${u} <${i}.${+o+1}.0-0`),R("xRange return",s),s})},Hs=(t,e)=>(R("replaceStars",t,e),t.trim().replace(O[N.STAR],"")),ks=(t,e)=>(R("replaceGTE0",t,e),t.trim().replace(O[e.includePrerelease?N.GTE0PRE:N.GTE0],"")),Ms=t=>(e,r,s,n,i,o,l,u,h,$,f,I)=>(d(s)?r="":d(n)?r=`>=${s}.0.0${t?"-0":""}`:d(i)?r=`>=${s}.${n}.0${t?"-0":""}`:o?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,d(h)?u="":d($)?u=`<${+h+1}.0.0-0`:d(f)?u=`<${h}.${+$+1}.0-0`:I?u=`<=${h}.${$}.${f}-${I}`:t?u=`<${h}.${$}.${+f+1}-0`:u=`<=${u}`,`${r} ${u}`.trim()),Bs=(t,e,r)=>{for(let s=0;s<t.length;s++)if(!t[s].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let s=0;s<t.length;s++)if(R(t[s].semver),t[s].semver!==ie.ANY&&t[s].semver.prerelease.length>0){let n=t[s].semver;if(n.major===e.major&&n.minor===e.minor&&n.patch===e.patch)return!0}return!1}return!0}});var C=p((bi,Or)=>{"use strict";var y=Symbol("SemVer ANY"),ae=class t{static get ANY(){return y}constructor(e,r){if(r=Rr(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),ce("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===y?this.value="":this.value=this.operator+this.semver.version,ce("comp",this)}parse(e){let r=this.options.loose?Ir[Lr.COMPARATORLOOSE]:Ir[Lr.COMPARATOR],s=e.match(r);if(!s)throw new TypeError(`Invalid comparator: ${e}`);this.operator=s[1]!==void 0?s[1]:"",this.operator==="="&&(this.operator=""),s[2]?this.semver=new Nr(s[2],this.options.loose):this.semver=y}toString(){return this.value}test(e){if(ce("Comparator.test",e,this.options.loose),this.semver===y||e===y)return!0;if(typeof e=="string")try{e=new Nr(e,this.options)}catch{return!1}return oe(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new dr(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new dr(this.value,r).test(e.semver):(r=Rr(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||oe(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||oe(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};Or.exports=ae;var Rr=F(),{safeRe:Ir,t:Lr}=q(),oe=te(),ce=P(),Nr=L(),dr=A()});var D=p((Hi,Sr)=>{"use strict";var Ys=A(),Ws=(t,e,r)=>{try{e=new Ys(e,r)}catch{return!1}return e.test(t)};Sr.exports=Ws});var Tr=p((ki,Ar)=>{"use strict";var zs=A(),Ks=(t,e)=>new zs(t,e).set.map(r=>r.map(s=>s.value).join(" ").trim().split(" "));Ar.exports=Ks});var qr=p((Mi,gr)=>{"use strict";var Js=L(),Zs=A(),Qs=(t,e,r)=>{let s=null,n=null,i=null;try{i=new Zs(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!s||n.compare(o)===-1)&&(s=o,n=new Js(s,r))}),s};gr.exports=Qs});var vr=p((Bi,wr)=>{"use strict";var en=L(),rn=A(),tn=(t,e,r)=>{let s=null,n=null,i=null;try{i=new rn(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!s||n.compare(o)===1)&&(s=o,n=new en(s,r))}),s};wr.exports=tn});var Cr=p((Yi,xr)=>{"use strict";var le=L(),sn=A(),Pr=x(),nn=(t,e)=>{t=new sn(t,e);let r=new le("0.0.0");if(t.test(r)||(r=new le("0.0.0-0"),t.test(r)))return r;r=null;for(let s=0;s<t.set.length;++s){let n=t.set[s],i=null;n.forEach(o=>{let l=new le(o.semver.version);switch(o.operator){case">":l.prerelease.length===0?l.patch++:l.prerelease.push(0),l.raw=l.format();case"":case">=":(!i||Pr(l,i))&&(i=l);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),i&&(!r||Pr(r,i))&&(r=i)}return r&&t.test(r)?r:null};xr.exports=nn});var Dr=p((Wi,yr)=>{"use strict";var on=A(),cn=(t,e)=>{try{return new on(t,e).range||"*"}catch{return null}};yr.exports=cn});var Y=p((zi,Ur)=>{"use strict";var an=L(),jr=C(),{ANY:ln}=jr,un=A(),fn=D(),Gr=x(),Fr=b(),En=k(),hn=H(),pn=(t,e,r,s)=>{t=new an(t,s),e=new un(e,s);let n,i,o,l,u;switch(r){case">":n=Gr,i=En,o=Fr,l=">",u=">=";break;case"<":n=Fr,i=hn,o=Gr,l="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(fn(t,e,s))return!1;for(let h=0;h<e.set.length;++h){let $=e.set[h],f=null,I=null;if($.forEach(E=>{E.semver===ln&&(E=new jr(">=0.0.0")),f=f||E,I=I||E,n(E.semver,f.semver,s)?f=E:o(E.semver,I.semver,s)&&(I=E)}),f.operator===l||f.operator===u||(!I.operator||I.operator===l)&&i(t,I.semver))return!1;if(I.operator===u&&o(t,I.semver))return!1}return!0};Ur.exports=pn});var Vr=p((Ki,Xr)=>{"use strict";var mn=Y(),$n=(t,e,r)=>mn(t,e,">",r);Xr.exports=$n});var br=p((Ji,_r)=>{"use strict";var Rn=Y(),In=(t,e,r)=>Rn(t,e,"<",r);_r.exports=In});var Mr=p((Zi,kr)=>{"use strict";var Hr=A(),Ln=(t,e,r)=>(t=new Hr(t,r),e=new Hr(e,r),t.intersects(e,r));kr.exports=Ln});var Yr=p((Qi,Br)=>{"use strict";var Nn=D(),dn=S();Br.exports=(t,e,r)=>{let s=[],n=null,i=null,o=t.sort(($,f)=>dn($,f,r));for(let $ of o)Nn($,e,r)?(i=$,n||(n=$)):(i&&s.push([n,i]),i=null,n=null);n&&s.push([n,null]);let l=[];for(let[$,f]of s)$===f?l.push($):!f&&$===o[0]?l.push("*"):f?$===o[0]?l.push(`<=${f}`):l.push(`${$} - ${f}`):l.push(`>=${$}`);let u=l.join(" || "),h=typeof e.raw=="string"?e.raw:String(e);return u.length<h.length?u:e}});var Qr=p((eo,Zr)=>{"use strict";var Wr=A(),fe=C(),{ANY:ue}=fe,G=D(),Ee=S(),On=(t,e,r={})=>{if(t===e)return!0;t=new Wr(t,r),e=new Wr(e,r);let s=!1;e:for(let n of t.set){for(let i of e.set){let o=An(n,i,r);if(s=s||o!==null,o)continue e}if(s)return!1}return!0},Sn=[new fe(">=0.0.0-0")],zr=[new fe(">=0.0.0")],An=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===ue){if(e.length===1&&e[0].semver===ue)return!0;r.includePrerelease?t=Sn:t=zr}if(e.length===1&&e[0].semver===ue){if(r.includePrerelease)return!0;e=zr}let s=new Set,n,i;for(let E of t)E.operator===">"||E.operator===">="?n=Kr(n,E,r):E.operator==="<"||E.operator==="<="?i=Jr(i,E,r):s.add(E.semver);if(s.size>1)return null;let o;if(n&&i){if(o=Ee(n.semver,i.semver,r),o>0)return null;if(o===0&&(n.operator!==">="||i.operator!=="<="))return null}for(let E of s){if(n&&!G(E,String(n),r)||i&&!G(E,String(i),r))return null;for(let it of e)if(!G(E,String(it),r))return!1;return!0}let l,u,h,$,f=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1,I=n&&!r.includePrerelease&&n.semver.prerelease.length?n.semver:!1;f&&f.prerelease.length===1&&i.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(let E of e){if($=$||E.operator===">"||E.operator===">=",h=h||E.operator==="<"||E.operator==="<=",n){if(I&&E.semver.prerelease&&E.semver.prerelease.length&&E.semver.major===I.major&&E.semver.minor===I.minor&&E.semver.patch===I.patch&&(I=!1),E.operator===">"||E.operator===">="){if(l=Kr(n,E,r),l===E&&l!==n)return!1}else if(n.operator===">="&&!G(n.semver,String(E),r))return!1}if(i){if(f&&E.semver.prerelease&&E.semver.prerelease.length&&E.semver.major===f.major&&E.semver.minor===f.minor&&E.semver.patch===f.patch&&(f=!1),E.operator==="<"||E.operator==="<="){if(u=Jr(i,E,r),u===E&&u!==i)return!1}else if(i.operator==="<="&&!G(i.semver,String(E),r))return!1}if(!E.operator&&(i||n)&&o!==0)return!1}return!(n&&h&&!i&&o!==0||i&&$&&!n&&o!==0||I||f)},Kr=(t,e,r)=>{if(!t)return e;let s=Ee(t.semver,e.semver,r);return s>0?t:s<0||e.operator===">"&&t.operator===">="?e:t},Jr=(t,e,r)=>{if(!t)return e;let s=Ee(t.semver,e.semver,r);return s<0?t:s>0||e.operator==="<"&&t.operator==="<="?e:t};Zr.exports=On});var st=p((ro,tt)=>{"use strict";var he=q(),et=v(),Tn=L(),rt=Z(),gn=g(),qn=qe(),wn=ve(),vn=Ce(),Pn=Ge(),xn=je(),Cn=Xe(),yn=_e(),Dn=He(),Gn=S(),Fn=Ye(),jn=ze(),Un=_(),Xn=Qe(),Vn=rr(),_n=x(),bn=b(),Hn=ee(),kn=re(),Mn=H(),Bn=k(),Yn=te(),Wn=ur(),zn=C(),Kn=A(),Jn=D(),Zn=Tr(),Qn=qr(),ei=vr(),ri=Cr(),ti=Dr(),si=Y(),ni=Vr(),ii=br(),oi=Mr(),ci=Yr(),ai=Qr();tt.exports={parse:gn,valid:qn,clean:wn,inc:vn,diff:Pn,major:xn,minor:Cn,patch:yn,prerelease:Dn,compare:Gn,rcompare:Fn,compareLoose:jn,compareBuild:Un,sort:Xn,rsort:Vn,gt:_n,lt:bn,eq:Hn,neq:kn,gte:Mn,lte:Bn,cmp:Yn,coerce:Wn,Comparator:zn,Range:Kn,satisfies:Jn,toComparators:Zn,maxSatisfying:Qn,minSatisfying:ei,minVersion:ri,validRange:ti,outside:si,gtr:ni,ltr:ii,intersects:oi,simplifyRange:ci,subset:ai,SemVer:Tn,re:he.re,src:he.src,tokens:he.t,SEMVER_SPEC_VERSION:et.SEMVER_SPEC_VERSION,RELEASE_TYPES:et.RELEASE_TYPES,compareIdentifiers:rt.compareIdentifiers,rcompareIdentifiers:rt.rcompareIdentifiers}});var W=require("fs"),z=Et(st()),nt=process.env.GITHUB_TOKEN;nt||(console.error("GITHUB_TOKEN is required"),process.exit(1));async function li(t){let e=await fetch(`https://api.github.com${t}`,{headers:{"User-Agent":"supplychain-guard",Authorization:`Bearer ${nt}`,Accept:"application/vnd.github+json"}});if(!e.ok)throw new Error(`GitHub API ${e.status}`);return e.json()}async function ui(){let t=[];for(let r=1;r<=10;r++){let s=await li(`/advisories?type=malware&ecosystem=npm&per_page=100&page=${r}`);if(t.push(...s),!Array.isArray(s)||s.length<100)break}let e=new Map;for(let r of t)for(let s of r?.vulnerabilities??[]){let n=s?.package?.name,i=s?.vulnerable_version_range;if(!n||!i)continue;let o=e.get(n)??[];o.push(i),e.set(n,o)}return e}(async function(){let e=process.argv[2],r=String(process.argv[3]||"false")==="true";(0,W.existsSync)(e)||(console.error(`Error: changed.json file not found: ${e}`),process.exit(1));let s=JSON.parse((0,W.readFileSync)(e,"utf8")),n=await ui(),i=[];for(let{name:o,version:l}of s){let u=n.get(o)||[],h=z.coerce(l);h&&u.some($=>{try{return z.satisfies(h,$,{includePrerelease:!0})}catch{return!1}})&&i.push({name:o,version:l})}if(i.length){let o=`Malware advisory hit:
`+i.map(l=>`- ${l.name}@${l.version}`).join(`
`);r?console.warn(o):(console.error(o),process.exit(1))}})();
