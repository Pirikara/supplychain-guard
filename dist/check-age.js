"use strict";var u=require("child_process"),r=require("fs");function l(c,e){try{let t=(0,u.execSync)(`npm view ${c}@${e} time --json`,{encoding:"utf8"}),o=JSON.parse(t)?.[e];return o?new Date(o):null}catch{return null}}(function(){let e=process.argv[2],t=parseInt(process.argv[3]||"7",10),g=String(process.argv[4]||"true")==="true";(0,r.existsSync)(e)||(console.error(`Error: changed.json file not found: ${e}`),process.exit(1));let o=JSON.parse((0,r.readFileSync)(e,"utf8")),i=[];for(let{name:s,version:n}of o){let a=l(s,n);if(!a)continue;let m=(Date.now()-a.getTime())/864e5;m<t&&i.push({name:s,version:n,publishedAt:a.toISOString(),ageDays:+m.toFixed(2)})}if(i.length){let s=`minimumReleaseAge < ${t}d:
`+i.map(n=>`- ${n.name}@${n.version} (${n.ageDays}d, ${n.publishedAt})`).join(`
`);g?console.warn(s):(console.error(s),process.exit(1))}})();
