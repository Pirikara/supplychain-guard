"use strict";var s=require("fs"),g=require("path"),l={npm:"npm",pip:"pypi","rust-crate":"crates-io",go:"go",rubygems:"rubygems",nuget:"nuget",maven:"maven"};(function(){let r=process.argv[2],f=process.argv[3];(0,s.existsSync)(r)||(console.error(`Error: changed.json file not found: ${r}`),process.exit(1));let m=JSON.parse((0,s.readFileSync)(r,"utf8")),t={};for(let e of m){let o=l[e.ecosystem];o&&(t[o]||(t[o]=[]),t[o].push(e.name))}let c=[];for(let[e,o]of Object.entries(t)){let n=(0,g.join)(f,"osv","malicious",e),i=[];try{if((0,s.existsSync)(n)){let p=new Set(o);for(let a of(0,s.readdirSync)(n)){let y=(0,g.join)(n,a);(0,s.lstatSync)(y).isDirectory()&&p.has(a)&&i.push(a)}}}catch{}i.length>0&&c.push({ecosystem:e,packages:i})}if(c.length>0){console.warn("OpenSSF malicious-packages (name match):");for(let{ecosystem:e,packages:o}of c){console.warn(`  ${e}:`);for(let n of o)console.warn(`    - ${n}`)}}})();
